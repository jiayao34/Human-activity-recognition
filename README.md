# Human-activity-recognition
Using UCI dataset
Human Activity Recognition
Jiayao Yuan

Classification algorithms were developed to classify 13 different human activities, such as cycling, running, climbing stairs, null activity, etc. The data was collected from ten subjects using four different sensors (accelerometer, gyroscope, magnetometer, and ECG) at three different body locations (right arm, left ankle, and chest) with a total of 23 signals. The goal of my work is to achieve an accuracy of 80%+ when testing algorithms on new subjects, and an accuracy of 90%+ when new subject labels are available. 

The signals are pretty clean in general, thus no signal filtering applied. The data is extremely unbalanced due to large amount of the null activity labeled as 0. Hence, down sampling of the null activity was applied. By visually inspecting the signals, certain activities have unique patterns. Therefore, classification using simple ML models and/or deep learning models should be able to classify easily between different human activities. Alternatively, I can use traditional manual feature extraction for this problem, since histograms also show separable distribution across different activities. In this work, I stayed with ML/DL models since they can reduce the workload of feature design by constructing an end-to-end structure to automatically learn and capture more high-level and meaningful features. 

For data pre-processing, I 1) down sampled the null activity to account for unbalanced dataset, 2) normalized input data for faster convergence, 3) for model training, I shuffled training-testing dataset based on samples (80% for training, 20% for testing) and also based on subjects (8 subjects for training, and 2 subjects for testing), 4) for CNN models, I sequenced the signal with specified window size and step. I tuned and trained the classic ML algorithms such as KNN, SVM, RF, and XGB. These models performed very well (95%+ accuracy) when tested based on samples (80% for training, 20% for testing). However, these models perform badly (<60% accuracy) when tested the algorithms on new subjects. I thus seek more complicated models to extract deeper level features so that the developed model can be more generalized for new subjects. 

First, I developed a 1-D convolutional neural network for this classification problem. My first design of 1-D CNN follows the LeNet-5, a well-accepted and not so deep architecture, as any deeper architecture may cause extra expense in computation and overfitting. To further improve the performance, I gradually modify the 1-D CNN from LeNet-5. After tuning the architecture, I was able to get almost 100% accuracy when tested based on samples, and I improved the accuracy to 75%+ when tested on new subjects using the developed 1-D CNN. Further, I added more complexity to the model by including an LSTM layer. An RNN LSTM structure can extract more information from the temporal behavior of the signals. Due to high computation cost, I had to apply dimension reduction to the input data. I utilized XGBoost algorithm which is able to find the most important features by computing GINI impurity scores. After selecting the more important features (gyroscopic sensor and accelerometer), and including batch normalization layers, I tuned ConvLSTM models and achieved 88%+ accuracy when tested on new subjects. 

Challenges in this project are: 1) data is not generic across different subjects, and 2) DL model training is computationally expensive on local computer.
